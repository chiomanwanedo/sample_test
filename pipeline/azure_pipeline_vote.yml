- checkout: votingapp
  path: example-voting-app

- task: Docker@2
  displayName: Build and Push 'vote' image
  inputs:
    containerRegistry: 'dockeracr'
    repository: 'vote'
    command: 'buildAndPush'
    Dockerfile: 'example-voting-app/vote/Dockerfile'
    tags: |
      $(IMAGE_TAG)

- task: Docker@2
  displayName: Build and Push 'result' image
  inputs:
    containerRegistry: 'dockeracr'
    repository: 'result'
    command: 'buildAndPush'
    Dockerfile: 'example-voting-app/result/Dockerfile'
    tags: |
      $(IMAGE_TAG)

- task: Docker@2
  displayName: Build and Push 'worker' image
  inputs:
    containerRegistry: 'dockeracr'
    repository: 'worker'
    command: 'buildAndPush'
    Dockerfile: 'example-voting-app/worker/Dockerfile'
    tags: |
      $(IMAGE_TAG)
